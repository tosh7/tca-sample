name: MergeDevelopToDevelop

on:
  workflow_dispatch:
    inputs:
        to:
            description: 'To branch'
            required: true

jobs:
    create_pull_request:
        runs-on: macos-latest
        permissions:
            contents: write
            pull-requests: write
        steps:
            - name: Checkout
              uses: actions/checkout@v4
              with: 
                token: ${{ secrets.GITHUB_TOKEN }}
            - run: echo "BASE=${GITHUB_REF#refs/heads/}" >> "${GITHUB_OUTPUT}"
              id: base-name
            - run: |
                git config --local user.name "${GitHub_ACTOR}"
                git config --local user.email "${GitHub_ACTOR}@users.noreply.github.com"
            - name: switch to from branch and rename
              run: |
                git checkout -b merge-${{ secrets.GITHUB_TOKEN }}-to-${{ github.event.inputs.to }}
                git push origin merge-${{ secrets.GITHUB_TOKEN }}-to-${{ github.event.inputs.to }}
            - name: Create Pull Request
              uses: actions/github-script@v6
              with:
                github-token: ${{ secrets.GITHUB_TOKEN }}
                script: |
                  github.rest.pulls.create({
                    owner: context.repo.owner,
                    repo: context.repo.repo,
                    title: 'Merge ${{ steps.base-name.outputs.BASE }} to ${{ github.event.inputs.to }}',
                    body: '${{ steps.base-name.outputs.BASE }}から${{ github.event.inputs.to }}へマージするPRを作成します。',
                    head: 'merge-${{ steps.base-name.outputs.BASE }}-to-${{ github.event.inputs.to }}',
                    base: '${{ github.event.inputs.to }}'
                  })
